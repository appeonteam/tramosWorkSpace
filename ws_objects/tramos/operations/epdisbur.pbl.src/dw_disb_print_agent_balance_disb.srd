$PBExportHeader$dw_disb_print_agent_balance_disb.srd
$PBExportComments$Disbursement part of agent balance composite report.
release 5;
datawindow(units=0 timer_interval=0 color=16777215 processing=0 print.documentname="" print.orientation = 0 print.margin.left = 110 print.margin.right = 110 print.margin.top = 97 print.margin.bottom = 97 print.paper.source = 0 print.paper.size = 0 print.prompt=no )
header(height=137 color="536870912" )
summary(height=1 color="536870912" )
footer(height=9 color="536870912" )
detail(height=329 color="536870912" )
table(column=(type=number updatewhereclause=yes name=disbursements_vessel_nr dbname="DISBURSEMENTS.VESSEL_NR" )
 column=(type=char(7) updatewhereclause=yes name=disbursements_voyage_nr dbname="DISBURSEMENTS.VOYAGE_NR" )
 column=(type=char(10) updatewhereclause=yes name=disbursements_port_code dbname="DISBURSEMENTS.PORT_CODE" )
 column=(type=number updatewhereclause=yes name=disbursements_pcn dbname="DISBURSEMENTS.PCN" )
 column=(type=char(20) updatewhereclause=yes name=agents_apm_acc_nr dbname="AGENTS.NOM_ACC_NR" )
 column=(type=datetime updatewhereclause=yes name=disbursements_disb_dept_dt dbname="DISBURSEMENTS.DISB_DEPT_DT" )
 column=(type=char(3) updatewhereclause=yes name=disbursements_disbursement_currency dbname="DISBURSEMENTS.DISBURSEMENT_CURRENCY" )
 column=(type=number updatewhereclause=yes name=disbursements_disb_ex_rate dbname="DISBURSEMENTS.DISB_EX_RATE" )
 column=(type=number updatewhereclause=yes name=disbursement_in_local_curr dbname="compute_0009" )
 column=(type=number updatewhereclause=yes name=disbursement_in_payment_curr dbname="compute_0010" )
 column=(type=number updatewhereclause=yes name=currency_total dbname="compute_0011" )
 retrieve="PBSELECT( VERSION(400) DISTINCT ()TABLE(NAME=~"AGENTS~" ) TABLE(NAME=~"DISBURSEMENTS~" ) TABLE(NAME=~"DISB_EXPENSES~" ) COLUMN(NAME=~"DISBURSEMENTS.VESSEL_NR~") COLUMN(NAME=~"DISBURSEMENTS.VOYAGE_NR~") COLUMN(NAME=~"DISBURSEMENTS.PORT_CODE~") COLUMN(NAME=~"DISBURSEMENTS.PCN~") COLUMN(NAME=~"AGENTS.NOM_ACC_NR~") COLUMN(NAME=~"DISBURSEMENTS.DISB_DEPT_DT~") COLUMN(NAME=~"DISBURSEMENTS.DISBURSEMENT_CURRENCY~") COLUMN(NAME=~"DISBURSEMENTS.DISB_EX_RATE~") COMPUTE(NAME=~"sum(DISB_EXPENSES.EXP_AMOUNT_LOCAL)~") COMPUTE(NAME=~"sum(ROUND(((DISB_EXPENSES.EXP_AMOUNT_LOCAL/DISBURSEMENTS.DISB_EX_RATE) *100),2))~") COMPUTE(NAME=~"sum(ROUND(((DISB_EXPENSES.EXP_AMOUNT_LOCAL/DISBURSEMENTS.DISB_EX_RATE) /100),2))~") JOIN (LEFT=~"DISBURSEMENTS.AGENT_NR~" OP =~"=~"RIGHT=~"DISB_EXPENSES.AGENT_NR~" OUTER1 =~"DISBURSEMENTS.AGENT_NR~" ) JOIN (LEFT=~"DISBURSEMENTS.PORT_CODE~" OP =~"=~"RIGHT=~"DISB_EXPENSES.PORT_CODE~" OUTER1 =~"DISBURSEMENTS.PORT_CODE~" ) JOIN (LEFT=~"DISBURSEMENTS.VESSEL_NR~" OP =~"=~"RIGHT=~"DISB_EXPENSES.VESSEL_NR~" OUTER1 =~"DISBURSEMENTS.VESSEL_NR~" ) JOIN (LEFT=~"DISBURSEMENTS.VOYAGE_NR~" OP =~"=~"RIGHT=~"DISB_EXPENSES.VOYAGE_NR~" OUTER1 =~"DISBURSEMENTS.VOYAGE_NR~" ) JOIN (LEFT=~"DISBURSEMENTS.PCN~" OP =~"=~"RIGHT=~"DISB_EXPENSES.PCN~" OUTER1 =~"DISBURSEMENTS.PCN~" ) JOIN (LEFT=~"AGENTS.AGENT_NR~" OP =~"=~"RIGHT=~"DISBURSEMENTS.AGENT_NR~" )WHERE( EXP1 =~"AGENTS.NOM_ACC_NR~" OP =~"=~" EXP2 =~":apm_acc_nr~" LOGIC =~"and~" ) WHERE( EXP1 =~"DISBURSEMENTS.DISB_IN_BALANCE~" OP =~"=~" EXP2 =~"0~" ) GROUP(NAME=~"DISBURSEMENTS.VESSEL_NR~") GROUP(NAME=~"AGENTS.NOM_ACC_NR~") GROUP(NAME=~"DISBURSEMENTS.PCN~") GROUP(NAME=~"DISBURSEMENTS.DISBURSEMENT_CURRENCY~") GROUP(NAME=~"DISBURSEMENTS.PORT_CODE~") GROUP(NAME=~"DISBURSEMENTS.VOYAGE_NR~") GROUP(NAME=~"DISBURSEMENTS.DISB_EX_RATE~") GROUP(NAME=~"DISBURSEMENTS.DISB_DEPT_DT~")) ORDER(NAME=~"DISBURSEMENTS.DISBURSEMENT_CURRENCY~" ASC=yes ) ORDER(NAME=~"DISBURSEMENTS.VESSEL_NR~" ASC=yes ) ORDER(NAME=~"DISBURSEMENTS.VOYAGE_NR~" ASC=yes ) ORDER(NAME=~"DISBURSEMENTS.PORT_CODE~" ASC=yes ) ORDER(NAME=~"DISBURSEMENTS.PCN~" ASC=yes ) ARG(NAME = ~"apm_acc_nr~" TYPE = string) " arguments=(("apm_acc_nr", string)) )
group(level=1 header.height=89 trailer.height=137 by=("disbursements_disbursement_currency" ) header.color="16777215" trailer.color="12632256" )
text(band=header alignment="0" text="Date :"border="0" color="0" x="403" y="4" height="57" width="129"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
compute(band=header alignment="0" expression="today()"border="0" color="0" x="549" y="4" height="65" width="247" format="dd-mmm-yy"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
text(band=header alignment="1" text="Disbursement"border="0" color="0" x="97" y="84" height="57" width="362"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
text(band=header alignment="1" text="Balance"border="0" color="0" x="718" y="84" height="57" width="197"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
line(band=detail x1="19" y1="324" x2="467" y2="324" pen.style="0" pen.width="5" pen.color="0"  background.mode="1" background.color="553648127" )
line(band=detail x1="471" y1="324" x2="919" y2="324" pen.style="0" pen.width="5" pen.color="0"  background.mode="1" background.color="553648127" )
column(band=detail id=9 alignment="1" tabsequence=32766 border="0" color="0" x="19" y="20" height="57" width="444" format="#,##0.00;-#,##0.00;0;0"  name=disbursement_in_local_curr edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
column(band=detail id=11 alignment="1" tabsequence=32766 border="0" color="0" x="485" y="20" height="57" width="430" format="#,##0.00"  name=currency_total edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
compute(band=detail alignment="1" expression="disbursement_in_local_curr /  disbursement_in_payment_curr"border="0" color="0" x="19" y="164" height="57" width="439" format="#,##0.00000"  name=reverse_ex_rate visible="1~t0"  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
column(band=detail id=10 alignment="0" tabsequence=32766 border="0" color="0" x="19" y="244" height="57" width="439" format="#,##0.00"  name=disbursement_in_payment_curr visible="1~t0" edit.limit=0 edit.case=any edit.autoselect=yes  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
compute(band=trailer.1 alignment="1" expression="sum(disbursement_in_local_curr for group 1)"border="0" color="0" x="19" y="4" height="61" width="444" format="#,##0.00;-#,##0.00;0;0"  name=disb_sum  font.face="Arial" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
compute(band=trailer.1 alignment="1" expression="sum(currency_total for group 1)"border="0" color="0" x="471" y="4" height="61" width="430" format="#,##0.00"  font.face="Arial" font.height="-8" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="553648127" )
